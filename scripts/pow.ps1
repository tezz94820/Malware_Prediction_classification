$AvSigVersion = (Get-MpComputerStatus).AntivirusSignatureVersion
$Census_OEMModelIdentifier = (Get-CimInstance -ClassName Win32_ComputerSystem).Model.TrimEnd('.')
$Remaining_Disks_Capacity = (Get-WmiObject Win32_LogicalDisk | Where-Object {$_.DriveType -eq 3} | Select-Object FreeSpace).FreeSpace
$C_drive_capacity = (Get-WmiObject Win32_LogicalDisk | Where-Object {$_.DeviceID -eq 'C:'} | Select-Object Size).Size
$Census_SystemVolumeTotalCapacity = (Get-WmiObject -Class Win32_Volume | Where-Object {$_.Label -eq "System"} | Select-Object -ExpandProperty Capacity) / 1MB
$Census_OSVersion = (Get-WmiObject -Class Win32_OperatingSystem).Version
$Census_OSBuildRevision = (Get-WmiObject -Class Win32_OperatingSystem).BuildNumber





#all  variables collected
$allVariables = @{
	"AvSigVersion" = $AvSigVersion
	"Census_OEMModelIdentifier" = $Census_OEMModelIdentifier
	"Remaining_Disks_Capacity" = $Remaining_Disks_Capacity
	"C_drive_capacity" = $C_drive_capacity
	"Census_SystemVolumeTotalCapacity" = $Census_SystemVolumeTotalCapacity
	"Census_OSVersion" = $Census_OSVersion
	"Census_OSBuildRevision" = $Census_OSBuildRevision	
}


#saving the variables in the config.txt file
$allVariables.GetEnumerator() | ForEach-Object { "$($_.Key)=$($_.Value)" } | Out-File -FilePath "C:\Users\tejas\OneDrive\Desktop\W_Scripts\scripts\config.txt"
Write-Host "Variables stored in output.txt"
Pause